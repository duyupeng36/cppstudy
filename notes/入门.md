---
aliases:
  - introduction
cssclasses:
  - introduction
tags:
  - cpp
  - cpp/introduction
summary: C++ 程序的基本组成
---
# 入门

了解一门程序设计语言的基本组成结构是学习它的第一步。下面我们介绍 C++ 的基本组成

## 第一个 C++ 程序

参考 [[设置 C++ 环境]] 中介绍的内容，我们已经配置好了 C++ 开发环境。是时候编写我们的第一个 C++ 程序了

```cpp title:firstcpp/main.cpp
#include <iostream>  // 加载预构建库

using namespace std;  // using 指示在 std 名字空间中的名字在当前作用域可见

int main() {
    // 向标准输出流 cout 写入字符串 "hello, world!"
    cout << "hello, world!" << endl;
    // 函数 main 的返回值
    return 0;
}
```

第一行代码 `#include <iostream>` 它用于声明在当前文件中包含 `iostream` 文件，这是由 C++ 提供的用于加载 **预构建库** 的功能。`iostream` 库用于帮助我们将数据输出到控制台，或者从标准输入中加载数据

然后是 `using namespace std;` 是一条语句，指示名字空间 `std` 中的名字在当前作用域中可见。这样我们就可以在代码中直接使用 `std` 名字空间中的名字。例如 `cout` 和 `endl`

> [!hint] 
> `cout` 是一个代表标准输出的 **流对象**，通过运算符 `<<` 将数据写入到 `cout` 的持有的缓冲区中
> 
> `endl` 是一个标准函数，它只做两件事情，向 `cout` 写入一个换行符(`\n`) 并刷新缓冲区

在 `using` 语句后名的 `int main(){}` 是函数定义语句，用于创建一个函数。在 C++ 中，函数就是一个代码块，其中包含了许多语句。这样，就可以使得一个函数可以做更多的事情

> [!attention] 
> `main()` 函数是一个特殊函数，在 C++ 中，它 C++ 程序执行的起点。这意味着当 C++ 程序正式执行起来时，`main()` 函数会是第一个被调用的函数
> 
> 当 `main()` 函数被调用时，其中的语句会按照顺序一条一条的向下执行，直到遇见 `main()` 函数中 `return` 语句，此时意味着程序将要退出。`main()` 函数的返回值代表了程序执行的状态，该值通常被操作系统或者该程序的执行进程的父进程使用
> + `main()` 函数返回 $0$ 通常意味着程序正常结束
> + `main()` 函数返回 **非零** 时，意味着程序执行出现异常

## 注释

**注释** 就是在 C++ 代码中插入一些由程序员阅读的消息，这些消息用于解释当前代码。C++ 标准提供了两种注释方法，分别是 **行注释** 和 **块注释**

```cpp title:comments/main.cpp
// 行注释：直到当前行结束。通常用于说明语句的作用
// 将 iostream 包含进入当前文件
#include <iostream>

int main() {

    // 向控制台输出字符串
    std::cout << "hello, world" << std::endl;

    return 0;  // 该语句执行完后，程序结束退出
}
```

上面的代码演示了行注释的使用。通常，行注释用于解释说明语句的作用；从 `//` 开始，直到当前行结束(遇见换行符)。

下面我们演示块注释的使用。通常用于解释说明函数的用途以及代码说明

```cpp title:comments/main.cpp

#include <iostream>

/* 块注释：用于包含多条注释内容。通常用于解释说明函数的用途以及代码文档
*/

/* 
main() 函数是 C++ 的特殊函数，用于规定程序执行的入口位置。
当程序加载到内存中开始执行时，第一个被调用的函数就是 main() 函数
*/
int main() {

    // 向控制台输出字符串
    std::cout << "hello, world" << std::endl;

    return 0;  // 该语句执行完后，程序结束退出
}
```

警告，**不要在块注释中嵌套另一个块注释**。这样会导致编译器对注释范围解析失败

```cpp
/* 块注释：用于包含多条注释内容。通常用于解释说明函数的用途以及代码文档

/* 嵌套的另一个块注释：会导致上层块注释范围解析错误 */
*/  // 错误。多出来了一个 */ 
```

## 错误和警告

对于 C++ 程序，我们需要运行一个编译器才能将 C++ 程序编译为一个可执行程序。编译器对我们的 C++ 代码有一组强制规则，以便于编译器能够成功程序目标文件。如果不满足这些规则，我们就会遇见问题。这些问题就会以 **编译时错误**、**运行时错误** 和 **警告** 的形式显示

### 编译时错误

我们首先来看编译错误。如下示例代码，我们忘记了在语句后面添加分号 (`;`)

```cpp title:errors_and_warnings/compiler_errors.cpp
#include <iostream>

int main() {

    std::cout << "hello, world" << std::endl  // 忘记添加分号了
    return 0;
}
```

当我们使用编译器编译时上述代码时，编译器会提示 `error: expected ';' before 'return'`。

![image.png|600](http://cdn.jsdelivr.net/gh/duyupeng36/images@master/obsidian/1757259629304-261859083b4044d68ae19999d37a5e79.png)

现在的编辑器会智能提示这些容易被忽视的错误，降低这种低级错误

> [!hint] 
> 编译错误通常是违反语法规则，导致编译器不能正常编译

### 运行时错误

运行时错误指的是那些在编译阶段没有被发现的错误，到了运行阶段才暴露出来的问题。例如，我们定义了一个执行整数除法函数；如果除数为 $0$，就会导致函数运行异常

> [!hint] 
> 运行时错误指程序并没有按照我们的要求执行，即使成功运行得到的也可能是错误的结果

```cpp title:errors_and_warnings/runtime_errors.cpp
#include <iostream>

using namespace std;

int divied(int a, int b) {
    // 没有检测除数 b 是否为 0
    return a / b;
}

int main() {

    // RuntimeError: 除数为零
    int result = divied(2, 0);
    cout << "result: "<< result << endl;
    return 0;
}
```

上述代码可以正常编译通过，但是在执行时，我们不会得到任何结果

![image.png|600](http://cdn.jsdelivr.net/gh/duyupeng36/images@master/obsidian/1757260552468-37cb08eef35e402d90eda41ffda05c36.png)

### 警告

**警告** 是一种提示信息，编译器提示警告的语句通常意味着这条语句在执行是会出现问题。我们应该执行程序执行器接近掉所有警告

```cpp title:errors_and_warnings/warings.cpp
#include <iostream>

int main() {

    int value = 7 / 0;  // 编译器知道除数为 0，因此在编译时会发出警告

    std::cout << "value: " << value << std::endl;
    return 0;
}
```

编译上述代码时，编译器会抛出警告信息。

![image.png|600](http://cdn.jsdelivr.net/gh/duyupeng36/images@master/obsidian/1757260849212-900b186e452f4031a888b06c9da13256.png)

> [!warning] 
> 有些编译器可能会直接抛出除数为 $0$ 的错误

## 语句和函数

### 语句

语句是 C++ 的基本单元，可以说是 CPU 在程序种可以执行的最小东西。 C++ 程序是一个语句的集合；换句话说，我们会编写一堆语句，它们以某种方式组织起来用于实现我们想要的任何东西

> [!important] 
> 请注意：C++ 中的语句要使用分号(`;`)结尾
> + 单纯的一个分号也是一条语句，即 **空语句**

我们将通过如下示例代码来学习 C++ 中的语句这一概念

```cpp title:statements_functions/statements.cpp
#include <iostream>

// using 指示语句
using namespace std;

int main() {

    // 声明语句
    int length{20};
    int width{10};
    int height{3};
    int volume;
    
    // 表达式语句
    volume = length * width * height;
    cout << "hello, world" << endl;

    // 返回语句
    return 0;
}
```

在上述示例代码中，我们在 `main()` 函数中看见了 $3$ 中类型的语句；分别是 **声明语句**、**表达式语句** 和 **返回语句**

> [!tip] 
> 声明语句用于声明程序对象，在上述示例中，声明语句用于声明了 $4$  个 **变量**。表达式语句用于计算值。返回语句用于将函数的返回值返回

请注意：语句在程序中 **顺序执行**，所谓的顺序执行就是指 **从上到下** 按照语句在程序中顺序一条一条的执行。直到到达程序的结尾，或者任何其他条件导致程序终止

### 函数

在 C++ 程序中，另一个非常重要的概念就是 **函数**。从本质上来说，**函数也是语句的集合**，这些语句会完成一些通用的操作。通过 **调用函数** 的方式复用这些语句。通常，一个函数需要接受一些输入，通过函数的语句集合进行处理，最后返回一个输出结果

例如，在学习语句概念中提供的示例代码。对于第 $15$ 行代码，我们就可以将其作为一个函数用于计算方体的体积

```cpp
```cpp hl:15
#include <iostream>

// using 指示语句
using namespace std;


// 定义函数
int calculate_volume(int length, int width, int height) {
    return length * width * height;
}

int main() {

    int length{20};
    int width{10};
    int height{3};
    int volume;
    
    // 调用函数
    volume = calculate_volume(length, width, height);
    cout << "hello, world" << endl;

    return 0;
}
```

C++ 采用下面的语法定义一个函数

```cpp
<return_type> <function_name>(<param_type param>, ...) {
	// 语句序列
	// return value;
}
```

> [!attention] 
> 在 C++ 中，函数必须在调用之前完成定义。所以，我们不能在 C++ 程序中调用一个没有定义的函数

## 标准输入和输出

在 C++ 中，标准输入输出在 `<iostream>` 中以下表列出的全局流对象提供

| 流对象         | 描述                            |
| :---------- | :---------------------------- |
| `std::cout` | 标准输出流：向屏幕输出数据，可以被重定向为向文件中写入数据 |
| `std::cin`  | 标准输入流：从键盘读取数据，可以被重定向为从文件中读取数据 |
| `std::cerr` | 标准错误流：用于向屏幕输出错误信息             |
| `std::clog` | 标准错误流：用于向屏幕输出日志信息             |

> [!tip] 
> 数据的输入和输出的过程就像水一样从一个地方流向另一个地方。因此，在 C/C++ 中，将此过程称为 **流(stream)**

关于它们之间的差异此处不会做任何介绍，后续在输入输出专题详细学习。在 C++ 中，流的基本操作依赖于输出运算符(`<<`) 和 输入运算符(`>>`)

> [!tip] 
> `<<` 和 `>>` 是用于整数的移位运算符，它们被重载用于执行输入输出。关于运算符重载会在后续专题中学习

`cout` `cerr` `clog` 这三个全局对象用于向屏幕输出数据。使用输出运算符 `<<` 输出数据时会自动格式化

```cpp
#include <iostream>

int main() {
    // Data output
    std::cout << "Data output: hello world!" << std::endl;

    int value{20};
    std::cout << "value = " << value << std::endl;

    // Error message
    std::cerr << "Error message: this is an error information" << std::endl;

    // Log message
    std::clog << "Log message: This is an info log" << std::endl;
    
    return 0;
}
```

全局对象 `cin` 用于从键盘中读取数据。使用输入运算符 `>>` 时，默认会 **在空白字符处截断**

```cpp
#include <iostream>
#include <string>

int main() {

    std::string name;
    int age;
    
    std::cout << "Please input your name and age, use a space to separate" << std::endl;
    // std::cin >> name;
    // std::cin >> age;
    std::cin >> name >> age;

    std::cout << "Hello " << name << ", your are " << age << " years old" << std::endl;

    return 0;
}
```

下图展示上述程序执行的结果

![image.png|600](http://cdn.jsdelivr.net/gh/duyupeng36/images@master/obsidian/1757348609012-bcf57a8f96c746ccae3115b2c6447ec2.png)

> [!hint] 
> 显然，`>>` 会自动在空白字符处结束读取，剩余内容会在一下次读取

如果需要包含空格的信息，可以使用 `std::getline()` 函数，该函数也包含在 `<iostream>` 头文件中

```cpp
#include <iostream>
#include <string>

int main()
{

    // getline
    std::string name;
    int age;
    std::cout << "Please input your name and age, use a space to separate" << std::endl;
    // 读取一行数据，直到遇见换行符为止
    std::getline(std::cin, name);
    std::cin >> age;
    std::cout << "Hello " << name << ", your are " << age << " years old" << std::endl;

    return 0;
}
```




